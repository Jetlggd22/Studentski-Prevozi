<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Študentski Prevozi - Najboljši Vozniki</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="Styles/Style.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <link rel="icon" href = "img/sp_favicon.png" type = "image/x-icon">
  <style>
    
    .drivers-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 2rem;
  margin-top: 2rem;
  margin-left: 20px;
}
@media (min-width: 900px) {
  .drivers-grid {
    grid-template-columns: repeat(3, 1fr);
  }
}
    
  </style>
</head>
<body>
  <!-- Loader -->
  <div class="loader" id="loader">
    <div class="loader-content">
      <div class="loader-spinner"></div>
      <div class="loader-logo">Študentski Prevozi</div>
    </div>
  </div>
  
  <!-- Header -->
   <header class="header" id="header">
    <div class="container header-container">
      <a href="#" class="logo">
        <i class="ri-focus-3-line logo-icon"></i>
        <span class="logo-text">Študentski Prevozi<span>
      </a>
      
          <ul class="nav-menu" id="nav-menu">
        <li class="nav-item">
          <a href="Index.html" class="nav-link">
            <i class="ri-home-4-line nav-icon"></i> Domov
          </a>
        </li>
        <li class="nav-item">
          <a href="Relacije.html" class="nav-link">
            <i class="ri-map-pin-line nav-icon"></i> Relacije
          </a>
        </li>
        <li class="nav-item">
          <a href="Vozniki.html" class="nav-link" style="color:gold;">
            <i class="ri-award-line nav-icon"></i> Vozniki
          </a>
        </li>
        <li class="nav-item">
          <a href="ONas.html" class="nav-link">
            <i class="ri-customer-service-2-line nav-icon"></i> O Nas
          </a>
        </li>
        
        <li class="nav-item">
          <a href="Login.html" class="nav-link"  id="login_profil">
            <i class="ri-login-circle-line nav-icon"></i> Prijava
          </a>
        </li>
         
      </ul>

      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>
  
  <div class="overlay" id="overlay"></div>
  
  <!-- Drivers Hero Section -->
  <section class="drivers-hero">
    <div class="container">
      <h1 class="drivers-title">Najboljši Vozniki</h1>
      <p class="drivers-subtitle">Spoznajte naše najboljše študentske voznike, ki zagotavljajo varno, prijetno in zanesljivo vožnjo</p>
    </div>
  </section>
  
  <!-- New Search Bar Section -->
  <div class="container">
    <div class="drivers-search" data-aos="fade-up">
      <form class="search-container" id="drivers-search-form">
  <input type="text" class="search-input" id="search-query" placeholder="Išči voznike (ime, lokacija...)">
  <select class="search-select" id="search-rating">
    <option value="">Vse ocene</option>
    <option value="5">⭐ 5+</option>
    <option value="4.5">⭐ 4.5+</option>
    <option value="4">⭐ 4+</option>
  </select>
  <button type="submit" class="search-btn">
    <i class="ri-search-line"></i> Išči
  </button>
</form>
    </div>
  </div>

  <div class="drivers-grid" id="top-drivers-grid"></div>
  <div id="drivers-loader" style="display:none; text-align:center; padding:2rem;">
  <div class="loader-spinner" style="margin:auto;"></div>
</div>
  
  <!-- Footer -->
   <footer class="footer" id="contact">
  <div class="container">
    <div class="footer-grid">

      <div class="footer-col footer-about">
        <a href="#" class="logo">
          <i class="ri-focus-3-line logo-icon"></i>
          <span class="logo-text">Študentski Prevozi</span>
        </a>
        <p>Študentski Prevozi je vodilna študentska potovalna agencija, ki združuje luksuzna doživetja z ugodnimi cenami za nepozabne dogodivščine sodobnih raziskovalcev.</p>
        <div class="footer-social">
          <a href="#" class="social-link"><i class="ri-instagram-line"></i></a>
          <a href="#" class="social-link"><i class="ri-twitter-x-line"></i></a>
          <a href="#" class="social-link"><i class="ri-facebook-circle-line"></i></a>
          <a href="#" class="social-link"><i class="ri-linkedin-box-line"></i></a>
        </div>
      </div>

      <div class="footer-col footer-links">
        <h4>Podjetje</h4>
        <ul>
           <li><a href="Kontakt.html"><i class="ri-arrow-right-s-line"></i> Kontaktiraj nas</a></li>
          <li><a href="NasaEkipa.html"><i class="ri-arrow-right-s-line"></i> Naša ekipa</a></li>
          <li><a href="Blog.html"><i class="ri-arrow-right-s-line"></i> Blog</a></li>
        </ul>
      </div>

      <div class="footer-col footer-links">
        <h4>Podpora</h4>
        <ul>
          <li><a href="FAQ.html"><i class="ri-arrow-right-s-line"></i> Pogosta vprašanja</a></li>
         
          <li><a href="PolitikaZasebnosti.html"><i class="ri-arrow-right-s-line"></i> Politika zasebnosti</a></li>
          <li><a href="PogojiUporabe.html"><i class="ri-arrow-right-s-line"></i> Pogoji uporabe</a></li>
        </ul>
      </div>

      <div class="footer-col footer-subscribe">
        <h4>Naroči se</h4>
        <p>Naroči se na naš novičnik in bodi obveščen o novih destinacijah ter ekskluzivnih ponudbah.</p>
        <form>
          <input type="email" placeholder="Vnesi svoj e-naslov">
          <button type="submit"><i class="ri-send-plane-line"></i></button>
        </form>
      </div>

    </div>

    <div class="footer-bottom">
      <p>&copy; 2025 <span>Študentski Prevozi, Republika Slovenija, Europska Unija</span>. Vse pravice pridržane.</p>
    </div>
  </div>
</footer>
  
  <!-- Back to Top -->
  <div class="back-to-top" id="back-to-top">
    <i class="ri-arrow-up-line"></i>
  </div>
  
  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script>
    window.addEventListener('DOMContentLoaded', function() {
    
    if (sessionStorage.getItem('user')) {
        
        var login = document.getElementById('login_profil');
        if (login) {
            
            login.innerHTML = '<i class ="ri-user-fill"></i> Profil';
            login.href = 'Profil.html';
        }
    }
});



    // Loader
    window.addEventListener('load', () => {
      setTimeout(() => {
        document.getElementById('loader').style.opacity = '0';
        setTimeout(() => {
          document.getElementById('loader').style.display = 'none';
        }, 500);
      }, 1000);
    });
    
    // Init AOS
    AOS.init({
      duration: 800,
      easing: 'ease-in-out',
      once: true
    });
    
    // Mobile Navigation
    const hamburger = document.getElementById('hamburger');
    const navMenu = document.getElementById('nav-menu');
    const overlay = document.getElementById('overlay');
    const navLinks = document.querySelectorAll('.nav-link');
    
    hamburger.addEventListener('click', () => {
      hamburger.classList.toggle('active');
      navMenu.classList.toggle('active');
      overlay.classList.toggle('active');
      document.body.style.overflow = navMenu.classList.contains('active') ? 'hidden' : 'auto';
    });
    
    overlay.addEventListener('click', () => {
      hamburger.classList.remove('active');
      navMenu.classList.remove('active');
      overlay.classList.remove('active');
      document.body.style.overflow = 'auto';
    });
    
    navLinks.forEach(link => {
      link.addEventListener('click', () => {
        hamburger.classList.remove('active');
        navMenu.classList.remove('active');
        overlay.classList.remove('active');
        document.body.style.overflow = 'auto';
      });
    });
    
    // Header scroll effect
    const header = document.getElementById('header');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    });
    
    // Back to top
    const backToTop = document.getElementById('back-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 300) {
        backToTop.classList.add('show');
      } else {
        backToTop.classList.remove('show');
      }
    });
    
    backToTop.addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
    });

  document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById('drivers-search-form');
  const queryInput = document.getElementById('search-query');
  const ratingSelect = document.getElementById('search-rating');
  const grid = document.getElementById('top-drivers-grid');
  const driversLoader = document.getElementById('drivers-loader');

    function showDriversLoader() {
  if (driversLoader) driversLoader.style.display = 'block';
  if (grid) grid.style.display = 'none';
}
function hideDriversLoader() {
  if (driversLoader) driversLoader.style.display = 'none';
  if (grid) grid.style.display = '';
}

  function renderDrivers(drivers) {
  if (!drivers.length) {
    grid.innerHTML = '<div style="padding:2rem;">Ni voznikov za prikaz.</div>';
    return;
  }
  grid.innerHTML = drivers.map((driver, idx) => `
    <div class="driver-card${idx === 0 ? ' top-driver' : ''}" data-aos="fade-up"${idx > 0 ? ` data-aos-delay="${idx * 100}"` : ''} >
      <img src="${driver.Spol === 'Ž' ? 
        `https://randomuser.me/api/portraits/women/${(driver.imgIdx || (idx+20))%60}.jpg` : 
        `https://randomuser.me/api/portraits/men/${(driver.imgIdx || (idx+20))%60}.jpg`}" 
        alt="${driver.Ime || ''} ${driver.Priimek || ''}" class="driver-avatar">
      <h3 class="driver-name">${driver.Ime || ''} ${driver.Priimek || ''}</h3>
      <div class="driver-university">
        <i class="ri-building-2-line"></i> ${driver.Univerza || ''}
      </div>
      <div class="driver-rating">
        <i class="ri-star-fill"></i> ${driver.Ocena != null ? Number(driver.Ocena).toFixed(2) : '-'}
        ${driver.SteviloOcen ? `(${driver.SteviloOcen} ocen)` : ''}
      </div>
      <div class="driver-stats">
        <div class="driver-stat">
          <div class="driver-stat-value">${driver.Vozenj || '-'}</div>
          <div class="driver-stat-label">Voženj</div>
        </div>
        <div class="driver-stat">
          <div class="driver-stat-value">${driver.Zanesljivost ? driver.Zanesljivost + '%' : '-'}</div>
          <div class="driver-stat-label">Zanesljivost</div>
        </div>
      </div>
      <p class="driver-bio">${driver.Bio || (driver.Avto ? 'Avto: ' + driver.Avto : '')}</p>
      <div class="driver-route">
        <i class="ri-route-line"></i> ${driver.Relacija || ''}
      </div>
    </div>
  `).join('');
}

  // Prikaz top vozača
  async function fetchTopDrivers() {
    grid.innerHTML = '<div style="padding:2rem;">Nalaganje...</div>';
    try {
      const res = await fetch("http://localhost:3000/api/top-drivers");
      const json = await res.json();
      hideDriversLoader();
      if (!json.success || !Array.isArray(json.data)) throw new Error("Napaka pri nalaganju voznikov.");
      renderDrivers(json.data);
    } catch (err) {
      hideDriversLoader();
      grid.innerHTML = '<div style="padding:2rem;color:red;">Napaka pri nalaganju voznikov.</div>';
    }
  }

  // Prikaz rezultata pretrage
  async function fetchDrivers(query = '', rating = '') {
    showDriversLoader();
    grid.innerHTML = '<div style="padding:2rem;">Nalaganje...</div>';
    try {
      const params = new URLSearchParams();
      if (query) params.append('q', query);
      if (rating) params.append('rating', rating);
      const res = await fetch(`http://localhost:3000/api/search-drivers?${params.toString()}`);
      const json = await res.json();
      hideDriversLoader();
      if (!json.success || !Array.isArray(json.data)) throw new Error("Napaka pri nalaganju voznikov.");
      renderDrivers(json.data);
    } catch (err) {
      hideDriversLoader();
      grid.innerHTML = '<div style="padding:2rem;color:red;">Napaka pri nalaganju voznikov.</div>';
    }
  }

  // Prikaz top vozača na početku
  fetchTopDrivers();

  // Pretraga na submit
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    const query = queryInput.value.trim();
    const rating = ratingSelect.value;
    
    if (!query && !rating) {
      fetchTopDrivers();
    } else {
      fetchDrivers(query, rating);
    }
  });

  // Reset na prazno polje
  queryInput.addEventListener('input', () => {
    if (!queryInput.value.trim() && !ratingSelect.value) {
      fetchTopDrivers();
    }
  });
  ratingSelect.addEventListener('change', () => {
    if (!queryInput.value.trim() && !ratingSelect.value) {
      fetchTopDrivers();
    }
  });
});

    
  </script>
</body>
</html>