<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Študentski Prevozi - Išči In Rezerviraj</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel = "stylesheet" href = "Styles/Style.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/10.0.4/swiper-bundle.css" />
  <link rel="icon" href = "img/sp_favicon.png" type = "image/x-icon">
   <body>
  <!-- Loader -->
  <div class="loader" id="loader">
    <div class="loader-content">
      <div class="loader-spinner"></div>
      <div class="loader-logo">Študentski Prevozi</div>
    </div>
  </div>
  <!-- Header -->
 <header class="header" id="header">
    <div class="container header-container">
      <a href="#" class="logo">
        <i class="ri-focus-3-line logo-icon"></i>
        <span class="logo-text">Študentski Prevozi<span>
      </a>
      
      <ul class="nav-menu" id="nav-menu">
        <li class="nav-item">
          <a href="Index.html" class="nav-link">
            <i class="ri-home-4-line nav-icon"></i> Domov
          </a>
        </li>
        <li class="nav-item">
          <a href="Relacije.html" class="nav-link">
            <i class="ri-map-pin-line nav-icon"></i> Relacije
          </a>
        </li>
        <li class="nav-item">
          <a href="Vozniki.html" class="nav-link">
            <i class="ri-award-line nav-icon"></i> Vozniki
          </a>
        </li>
        <li class="nav-item">
          <a href="Storitve.html" class="nav-link">
            <i class="ri-information-line nav-icon"></i> Storitve
          </a>
        </li>
        <li class="nav-item">
          <a href="ONas.html" class="nav-link">
            <i class="ri-customer-service-2-line nav-icon"></i> O Nas
          </a>
        </li>
         <li class="nav-item">
          <a href="Login.html" class="nav-link">
            <i class="ri-login-circle-line nav-icon"></i> Prijava
          </a>
        </li>
         
      </ul>
      
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>
  
  <div class="overlay" id="overlay"></div>

  <!-- Hero Section -->
  <section class="services-hero">
    <div class="container">
      <h1 data-aos="fade-up">Podrobnosti Voznje</h1>
      <p data-aos="fade-up" data-aos-delay="100">Vse informacije o vaši izbrani vožnji</p>
    </div>
  </section>
  <!-- Title -->
   
  
<!--SEARCH CARD-->
   


  <!-- Ride Details Section -->

<section class="destinations" id="destinations">
  <div class="container">
    <div id="prevozDetails"></div>
  </div>
</section>

  <div id="commentModal" style="
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  ">
    <div style="
      background: black;
      padding: 20px;
      border-radius: 8px;
      width: 90%;
      max-width: 500px;
    ">
      <div style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      ">
        <h3 style="margin: 0;">Dodajte komentar</h3>
        <button id="closeModal" style="
          background: none;
          border: none;
          font-size: 20px;
          cursor: pointer;
        ">&times;</button>
      </div>
      
      <div style="margin-bottom: 15px;">
        <div style="margin-bottom: 5px;">Vaša ocena:</div>
      
      </div>
      
      <div style="margin-bottom: 15px;">
        <div style="margin-bottom: 5px;">Komentar:</div>
        <textarea id="commentText" style="
          width: 100%;
          padding: 10px;
          border: 1px solid #ddd;
          border-radius: 4px;
          min-height: 50px;
          background-color: black;
          color:white;
        "></textarea>
      </div>
      
      <div style="display: flex; justify-content: flex-end;">
        <button id="cancelComment" style="
          background-color: #312D18;
          color:white;
          border: none;
          padding: 8px 15px;
          border-radius: 4px;
          margin-right: 10px;
          cursor: pointer;
        " class = "cancelBtn btn btn-danger w-30">Prekliči</button>
        <button id="saveComment" class = "login-btn btn btn-primary w-30">Shrani</button>
      </div>
    </div>
  </div>
    
  </div>
  </div>
  </section>

  <!-- Footer -->
  <footer class="footer" id="contact">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-col footer-about">
          <a href="#" class="logo">
            <i class="ri-focus-3-line logo-icon"></i>
            <span class="logo-text">Študentski Prevozi</span>
          </a>
          <p>Študentski Prevozi je vodilna študentska potovalna agencija, ki združuje luksuzna doživetja z ugodnimi cenami za nepozabne dogodivščine sodobnih raziskovalcev.</p>
          <div class="footer-social">
            <a href="#" class="social-link"><i class="ri-instagram-line"></i></a>
            <a href="#" class="social-link"><i class="ri-twitter-x-line"></i></a>
            <a href="#" class="social-link"><i class="ri-facebook-circle-line"></i></a>
            <a href="#" class="social-link"><i class="ri-linkedin-box-line"></i></a>
          </div>
        </div>

        <div class="footer-col footer-links">
          <h4>Podjetje</h4>
          <ul>
            <li><a href="Kontakt.html"><i class="ri-arrow-right-s-line"></i> Kontaktiraj nas</a></li>
            <li><a href="NasaEkipa.html"><i class="ri-arrow-right-s-line"></i> Naša ekipa</a></li>
            <li><a href="Blog.html"><i class="ri-arrow-right-s-line"></i> Blog</a></li>
          </ul>
        </div>

        <div class="footer-col footer-links">
          <h4>Podpora</h4>
          <ul>
            <li><a href="FAQ.html"><i class="ri-arrow-right-s-line"></i> Pogosta vprašanja</a></li>
            <li><a href="PolitikaZasebnosti.html"><i class="ri-arrow-right-s-line"></i> Politika zasebnosti</a></li>
            <li><a href="PogojiUporabe.html"><i class="ri-arrow-right-s-line"></i> Pogoji uporabe</a></li>
          </ul>
        </div>

        <div class="footer-col footer-subscribe">
          <h4>Naroči se</h4>
          <p>Naroči se na naš novičnik in bodi obveščen o novih destinacijah ter ekskluzivnih ponudbah.</p>
          <form>
            <input type="email" placeholder="Vnesi svoj e-naslov">
            <button type="submit"><i class="ri-send-plane-line"></i></button>
          </form>
        </div>
      </div>

      <div class="footer-bottom">
        <p>&copy; 2025 <span>Študentski Prevozi, Republika Slovenija, Europska Unija</span>. Vse pravice pridržane.</p>
      </div>
    </div>
  </footer>

  <!-- Back to Top -->
   <div class="back-to-top" id="back-to-top">
    <i class="ri-arrow-up-line"></i>
  </div>
  
  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/10.0.4/swiper-bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Scripts -->
<script>
let selectedRating = 0;
let currentPrevozId = null;

window.addEventListener('load', () => {
  setTimeout(() => {
    document.getElementById('loader').style.opacity = '0';
    setTimeout(() => {
      document.getElementById('loader').style.display = 'none';
    }, 500);
  }, 1000);
});

AOS.init({ duration: 800, easing: 'ease-in-out', once: true, mirror: false });

const header = document.getElementById('header');
window.addEventListener('scroll', () => {
  header.classList.toggle('scrolled', window.scrollY > 50);
});

const backToTop = document.getElementById('back-to-top');
window.addEventListener('scroll', () => {
  backToTop.classList.toggle('show', window.scrollY > 300);
});
backToTop.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));

const hamburger = document.getElementById('hamburger');
const navMenu = document.getElementById('nav-menu');
const overlay = document.getElementById('overlay');
hamburger.addEventListener('click', () => {
  hamburger.classList.toggle('active');
  navMenu.classList.toggle('active');
  overlay.classList.toggle('active');
  document.body.style.overflow = navMenu.classList.contains('active') ? 'hidden' : 'auto';
});
overlay.addEventListener('click', () => {
  hamburger.classList.remove('active');
  navMenu.classList.remove('active');
  overlay.classList.remove('active');
  document.body.style.overflow = 'auto';
});

document.querySelectorAll('.nav-link').forEach(link => {
  link.addEventListener('click', () => {
    hamburger.classList.remove('active');
    navMenu.classList.remove('active');
    overlay.classList.remove('active');
    document.body.style.overflow = 'auto';
  });
});

document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      const offset = target.getBoundingClientRect().top + window.scrollY - header.offsetHeight;
      window.scrollTo({ top: offset, behavior: 'smooth' });
    }
  });
});

function setRating(container, rating) {
  if (!container) return;
  const stars = container.querySelectorAll('.star-img');
  stars.forEach(star => {
    const value = parseInt(star.dataset.rating);
    star.src = value <= rating ? 'img/star_fill.png' : 'img/star_empty.png';
  });
}

function openCommentModal(prevozId) {
  const modal = document.getElementById('commentModal');
  currentPrevozId = prevozId;
  selectedRating = +sessionStorage.getItem(`rating_${prevozId}`) || 0;
  document.getElementById('commentText').value = sessionStorage.getItem(`komentar_${prevozId}`) || '';
  setRating(document.querySelector('#commentModal .modal-stars'), selectedRating);
  modal.style.display = 'flex';
}

function initModalStars() {
  document.querySelectorAll('#commentModal .star-img').forEach(star => {
    star.addEventListener('click', function () {
      selectedRating = +this.dataset.rating;
      setRating(document.querySelector('#commentModal .modal-stars'), selectedRating);
    });
    star.addEventListener('mouseover', function () {
      setRating(document.querySelector('#commentModal .modal-stars'), +this.dataset.rating);
    });
    star.addEventListener('mouseout', () => {
      setRating(document.querySelector('#commentModal .modal-stars'), selectedRating);
    });
  });
}

document.getElementById('closeModal').onclick =
document.getElementById('cancelComment').onclick = () =>
  (document.getElementById('commentModal').style.display = 'none');

document.getElementById('saveComment').onclick = () => {
  const comment = document.getElementById('commentText').value;
  if (!selectedRating) return alert('Prosimo, izberite oceno!');
  if (!currentPrevozId) return alert('Napaka: ni izbrane relacije.');
  sessionStorage.setItem(`rating_${currentPrevozId}`, selectedRating);
  sessionStorage.setItem(`komentar_${currentPrevozId}`, comment);
  alert('Hvala za vašo oceno in komentar!');
  document.getElementById('commentModal').style.display = 'none';
};

document.addEventListener('DOMContentLoaded', async () => {
    const urlParams = new URLSearchParams(window.location.search);
    const prevozId = urlParams.get('id'); // Make sure URL is like ...?id=1

    if (!prevozId) {
      document.getElementById('prevozDetails').innerText = 'ID ni podan.';
      return;
    }

    try {
      const res = await fetch(`http://localhost:3000/api/prevozi/${prevozId}`);

      if (!res.ok) {
        document.getElementById('prevozDetails').innerText = 'Napaka pri nalaganju podatkov.';
        return;
      }

      const prevoz = await res.json();
      const datumObj = new Date(prevoz.Cas_odhoda);
const datum = datumObj.toLocaleDateString('sl-SI', {
  weekday: 'short', year: 'numeric', month: 'short', day: 'numeric'
});
const ura = datumObj.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

const html = `
  <div class="booking-card fade-in">
    <div class="booking-header">
      <h2 class="booking-title"><i class="ri-car-line"></i> Vožnja na ${prevoz.Prihod_Ime}
      <span style="float: right; font-size: 0.8em; color: gold;">Potrjeno</span></h2>
    </div>

    <div class="booking-body">
      <div class="route-display">
        <div class="location">
          <div class="location-name">${prevoz.Odhod_Ime}</div>
          <div class="location-time">${ura}</div>
        </div>
        <div class="route-line"></div>
        <div class="location">
          <div class="location-name">${prevoz.Prihod_Ime}</div>
          <div class="location-time">--</div>
        </div>
      </div>

      <div class="booking-details">
        <div class="detail-card"><div class="detail-label">Datum</div><div class="detail-value">${datum}</div></div>
        <div class="detail-card"><div class="detail-label">Cena</div><div class="detail-value">${prevoz.Cena}€</div></div>
        <div class="detail-card"><div class="detail-label">Prosta mesta</div><div class="detail-value">${prevoz.Prosta_mesta}</div></div>
        <div class="detail-card"><div class="detail-label">Ponavljanje</div><div class="detail-value">${prevoz.Ponavljanje}</div></div>
        <div class="detail-card"><div class="detail-label">Avto</div><div class="detail-value">${prevoz.Voznik_Avto}</div></div>
      </div>

      <div class="booking-details">
        <div class="detail-card"><div class="detail-label">Voznik</div><div class="detail-value">${prevoz.Voznik_Ime} ${prevoz.Voznik_Priimek}</div></div>
        <div class="detail-card"><div class="detail-label">Telefon</div><div class="detail-value">${prevoz.Voznik_Telefon}</div></div>
        <div class="detail-card"><div class="detail-label">Uporabnik</div><div class="detail-value">${prevoz.Voznik_Username}</div></div>
        <div class="detail-card"><div class="detail-label">Ocena</div><div class="detail-value">${prevoz.Voznik_Ocena.toFixed(1)}</div></div>
      </div>

      <div class="map-placeholder">
        <p style="color: #aaa; text-align: center; margin: 0; padding-top: 60px;">Tukaj bo zemljevid...</p>
      </div>

      <div class="price-section">
        <div class="price-info">
          <div class="price-label">Cena za potnika</div>
          <div class="price-amount">${prevoz.Cena}€</div>
        </div>
        <button class="book-btn">Rezerviraj zdaj <i class="ri-arrow-right-line"></i></button>
      </div>
    </div>
  </div>
`;

      document.getElementById('prevozDetails').innerHTML = html;

    } catch (error) {
      console.error('Napaka pri branju prevoza:', error);
      document.getElementById('prevozDetails').innerText = 'Napaka pri pridobivanju podatkov.';
    }
  });
</script>
</body>
</html>